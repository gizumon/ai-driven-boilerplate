# AI-driven development sample

※Jump to core part: [AI-driven Development 運用モデル](#ai-driven-development-運用モデル)

## プロジェクト概要

:::info
このセクションでは、下記の様なプロジェクトの基本情報を記載する。

- プロジェクトのバックグラウンド
- サービスの概要
- 技術スタック
- アーキテクチャ概要

なお、なるべく冗長な情報が含まれない様に再利用される様なドキュメントは、SkillsやRulesに記載し、リンクする様にする。
:::

### 目的

このプロジェクトは、AI駆動開発のベストプラクティスを実践するためのサンプルリポジトリです。
実際のコードは含まれておらず、実際のプロジェクトの構成をインプットに.claude配下のSubAgent、Skills、Rulesを生成することを想定しています。

下記は現在のSubAgent、Skills、Rulesを生成するためのインプットとした技術スタックと、アーキテクチャ概要の例です。
詳細は下記を参照ください。

- `.claude/plans/01_initial_backend_design.md`
- `.claude/plans/02_initial_frontend_design.md`

### 技術スタック

- フロントエンド:
  - 言語: TypeScript
  - フレームワーク: React Native + Expo
- バックエンド: 
  - 言語: Golang
  - フレームワーク: Chi
- インフラ:
  - プラットフォーム: GCP
  - IaC管理ツール: Terraform
  - CI/CD: GitHub Actions

### アーキテクチャ概要

- フロントエンド/バックエンド/インフラ/スキーマバージョン管理まで全てを含むMonorepo構成
- クリーンアーキテクチャをベースに、レイヤー分割された構造
- フロントエンドとバックエンドはAPIで疎結合
- インフラはコードで管理し、環境ごとに分割

---

下記はAI駆動開発を行う上での基本的な運用ルールを定めたドキュメント。

## AI-driven Development 運用モデル

このリポジトリは **SubAgent / Skills / Rules 分離モデル** に基づき、AI駆動開発を行う。  
目的は「責務分離・並列実行・重複排除・継続的改善」を徹底すること。

## 1. 基本構造

### SubAgent

**役割と責任範囲のみを定義する。**

含めるもの:
- 何をやるか（責務）
- 成果物
- 他SubAgentとの依存関係

含めないもの:
- ベストプラクティス
- 手順
- 技術詳細

それらは必ず Skills に分離する。

### Skills

**再利用可能な知識・ベストプラクティス・HowTo を定義する。**

含めるもの:
- 設計原則
- フレームワーク活用法
- ライブラリ統合方法
- テスト戦略
- セキュリティ指針
- ドキュメント作成ベストプラクティス

制約:
- 一時的仕様を書かない
- SubAgent固有情報を書かない
- 重複を作らない

### Rules

**必ず守る規則のみを書く。**

例:
- 命名規則
- ディレクトリ構造
- 依存関係ルール
- セキュリティ制約
- コード品質基準

Rulesは「守るべきこと」のみを記述する。  
方法論はSkillsへ。

## 2. タスク開始時の判断原則

#### ケース1: 適切なSubAgentが存在しない

以下の場合は必ず新規SubAgent作成から開始する:

- 責務境界が曖昧
- 並列実行できない
- 成果物が定義できない
- 他責務と混在している

SubAgentは**並列実行可能な単位**で分割する。

例:
- design-planner Agent
- document-maintainer Agent
- backend-developer Agent
- frontend-developer Agent
- infra-developer Agent
- qa-engineer Agent

#### ケース2: 新しい技術・外部サービス導入

- SubAgent内に直接知識を書かない
- 必ずSkillとして定義する
- 横断的再利用可能単位にする

## 3. タスク開始フロー（事例ベース）

### 新機能追加の場合

- design-planner Agentを起動
- 現状分析
- 影響範囲整理
- 実装ステップ分解
- `.claude/plans/<feature-name>.md` に出力

実装はその後。

### 仕様変更の場合

- design-planner Agentを起動
- 差分整理
- 移行計画作成
- `.claude/plans/` に出力

### 要件が曖昧な場合

- design-planner Agentが前提条件を明文化
- 仮説を列挙
- 不確定要素を可視化

## 4. ドキュメント配置ルール

### `.claude/plans/`

用途:
- 作業計画
- 変更ステップ
- 移行設計
- TODO分解

性質:
- 一時的
- プロセス中心

#### `todos.md` 運用ルール

`.claude/plans/todos.md` でタスク・検討事項を管理する。

- 実装中に「後でやるべきこと」「検討事項」を発見したら随時追記する
- タスク完了時には必ず `todos.md` を確認し、完了した項目にチェックを入れる

### `docs/`（Docusaurus）

`docs/` は Docusaurus で構築する。ドキュメントコンテンツは `docs/docs/` 配下に配置する。

用途:
- 完成仕様
- アーキテクチャ
- 設計思想
- 注意事項
- 将来検討事項

性質:
- 永続的
- 状態を表す
- 重複禁止

## 5. ドキュメント作成原則

ドキュメント作成方法はSkill化する。

必須条件:
- 1ファイル1責務
- 他ドキュメントと重複しない
- 対象読者が明確
- Gitで履歴管理（本文に履歴を書かない）

## 6. 実装開始条件

実装開始前に必ず確認:

- `.claude/plans` に計画が存在
- 影響範囲が整理済み
- 必要Skillが存在（無ければ作成済み）
- SubAgent責務が明確

## 7. 並列実行原則

複数SubAgentが動く場合:

- API契約を先に定義
- インターフェース明示
- 依存方向は単方向
- 循環依存禁止

## 8. 重複排除原則

禁止事項:

- SubAgentにノウハウを書く
- Skillsに一時仕様を書く
- Rulesにベストプラクティスを書く
- 同一設計を複数docsに書く

## 9. タスク終了時の改善プロセス

タスク完了時は必ず:

- 作業の失敗要因分析
- SubAgent分割の妥当性評価
- Skill不足確認
- Rulesの穴確認

改善が必要なら:

- Skill追加/修正
- SubAgent再設計
- Rules明文化

常にこのCLAUDE.md自体も改善対象とする。

## 10. 最重要セルフチェック

常に自問する:

- この責務は誰のものか？
- Skill化すべきか？
- Ruleか？
- 永続情報か一時情報か？
- 並列実行可能か？

### 開発思想

設計 → 分解 → 並列化 → Skill化 → 実装 → 検証 → 改善

このサイクルを継続的に回す。

## 11. **重要事項**

- 作成するドキュメントは全て**日本語**とすること
- コード内は全て**英語**とすること
- コミットをする際には "ai:" から始まるコミットメッセージを使用すること (例: "ai: Add new API endpoint for user registration")
