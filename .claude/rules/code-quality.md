# コード品質ルール

## Linter

- backend: golangci-lint
- frontend: Biome

## フォーマッター

- backend: gofmt
- frontend: Biome

## 型安全性

- TypeScript: strict mode 必須
- Go: 型アサーションの乱用禁止

## ログ

- 構造化ログ（JSON形式）
- request_id 付与
- Worker実行ログを明示的に出力

## エラーハンドリング

- Domain エラーを定義する
- Adapter エラーはラップする
- HTTP は適切なステータスコードを返却する

## 可観測性（Observability）

- KPIに必要なメトリクス値は構造化ログに含める
- 外部API呼び出し（OpenAI、FCM）にはレイテンシと結果をログ出力する
- Worker バッチ処理は開始/終了/処理件数/所要時間を必ずログ出力する
- ヘルスチェックエンドポイントを必ず実装する
- アラート条件に該当するエラーは適切な severity（ERROR / WARN）で出力する
- メトリクスサマリーAPIを実装し、フロントエンドからKPI取得可能にする

## 可読性

- 関数は単一責任を持つようにする
  - 1つの関数はできるだけ短く保つ（理想は20行以下、最大でも50行以下）
- コメントは必要最低限にし、コード自体が意図を表すようにする
- 複雑なロジックは適切に分割する
- 関数や変数の命名は意図が明確になるようにする (過去に定義した命名規則に従う)
- 不要なコードは削除する
- 定数やマジックナンバーは適切に定義する
